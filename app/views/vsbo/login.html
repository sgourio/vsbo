<!DOCTYPE html>

<html>
    <head>
        <title>#{get 'title' /}</title>
        <meta charset="UTF-8">
        <link rel="stylesheet" media="screen" href="@{'/public/stylesheets/bootstrap.min.css'}">
        <link rel="stylesheet" media="screen" href="@{'/public/stylesheets/vsbo.css'}">
        #{get 'moreStyles' /}
        <link rel="shortcut icon" type="image/png" href="@{'/public/images/favicon.png'}">
        <script src="@{'/public/javascripts/jquery-1.6.4.min.js'}" type="text/javascript" charset="UTF-8"></script>
        <script src="@{'/public/javascripts/bootstrap-dropdown.js'}" type="text/javascript" charset="UTF-8"></script> 
        <script type="text/javascript">
			$(document).ready(function(){
			 });
		</script>
        #{get 'moreScripts' /}
    </head>
    <body #{if play.mode.name() == 'DEV'}class="dev"#{/if}>

    	<div class="topbar">
	      <div class="fill">
	        <div class="container">
	          <a class="brand" href="@{vsbo.Backoffice.index()}">${play.configuration.getProperty("application.name")}</a>
	        </div>
	      </div>
	    </div>
        
    	<div class="container">
    		
	    	<div class="hero-unit">
    			<h1>${play.configuration.getProperty("application.name")}</h1>
	    	</div>
	    	#{form @vsbo.Secure.vsboAuth()}
	    	<div class="row">
	    		<div class="span8">
		    		#{if errorMessage}
		    			<p class="alert-message block-message error">${errorMessage}</p>
		    		#{/if}
		    		<h3>&{"vsbo.login.connect.with.account.title", play.configuration.getProperty("application.name")}</h3>
	    			 <div class="clearfix">
				        #{field 'email'}
				        <label>Email: </label>
				        <div class="input">
				        	<input type="text" name="${field.name}" value="" class="${field.errorClass}" size="100" />
				        </div>
				        #{/field}
				       
				    </div>
				    <div class="clearfix">
				     #{field 'password'}
				        <label>&{"vsbo.login.password"}: </label>
				        <div class="input">
				        	<input type="password" name="${field.name}" value="" class="${field.errorClass}" size="50" />
				        </div>
				     #{/field}
	    			</div>
		    		
		    	</div>
		    	<div class="span8">
		    		<h3>&{"vsbo.login.connect.with.google.title"}</h3>
		    	</div>
		    </div>
	    	<div class="row">
	    		<div class="span8">
	    			<div class="actions">
			    		<input type="submit" value="&{'vsbo.login.button.connect'}" class="btn primary"/>
			    	</div>
	    		</div>
	    		<div class="span8">
	    			<div class="actions">
		    			<a href="@{vsbo.Secure.auth()}" class="btn primary">&{"vsbo.login.button.google"}</a>
		    		</div>
	    		</div>
	    	</div>
	    	#{/form}
			#{if play.mode.name() == 'DEV'}
			<div class="row">
				<div class="span15 offset1 info">
					
					<div id="warningLess" style="display:none">
						VSBO utilise LESS pour compiler ses feuilles de style. Il faut ajouter le module au projet. Pour cela allez dans "dependencies.yml" et ajoutez la ligne:<br />
						require:<br />
					    - play<br />
					    - play -> less 0.3<br /><br /><br />
					    Vous devez ensuite passer les commandes play :<br />
					    play deps<br />
					    play eclipsify<br />
					    Et redémarrer le projet...
					</div>
					
					<div class="alert-message block-message info">
						<p>Ce bloc n'est affiché qu'en mode dev:</p>
						<p>Pour faire marcher l'authentification via Google suivez les étapes suivantes:</p>
						<h1>1. Enregistrez votre application auprès de Google</h1>
						<p>
							Allez sur <a href="https://code.google.com/apis/console#access">Google API</a>. <br />
							Suivez les étapes pour générer un clientID.<br />
							<br />
							Attention, vous allez certainement devoir changer la valeur par défaut de "Redirect URIs":<br/>
							Il faut qu'elle pointe vers "/vsbo/secure/auth" et le port 9000 ( utilisé par play )<br />
							<pre>
http://www.mysampleproject.com:9000/vsbo/secure/auth
							</pre>
							
							Créer un second clientID pour la prod (et ce coup ci vous ne mettrez pas le port 9000 dans la "redirect URIs")<br />
							<img src="@{'/public/images/googleapi.jpg'}" width="800px"/>
							<br /><br />
						</p>
						<h1>2. Mettez à jour votre configuration</h1>
						<p>
							Dans le fichier application.conf vous devez mettre à jour <br />
							<pre>
oAuth.ClientID=551654476579.apps.googleusercontent.com
oAuth.ClientSecret=mqCaMfPUVtL4u_jcEPGp31mE
oAuth.JavaScriptOrigins=https://www.mysampleproject.com

%prod.oAuth.ClientID=551654476579-sjes014975hmk3m686ugld97nvl21fbp.apps.googleusercontent.com
%prod.oAuth.ClientSecret=Th8oUWDAbIxSjK2TKCNnxhKa
%prod.oAuth.JavaScriptOrigins=https://www.mysampleproject.com/vsbo/secure/auth
							</pre>
						</p>
						<h1>3. Faites une redirection de votre nom de domaine en local</h1>
						<p>
							Allez éditer le fichier C:\WINDOWS\system32\drivers\etc\hosts<br />
							Exemple:<br />
							<pre>
127.0.0.1  localhost
127.0.0.1 www.mysampleproject.com
							</pre>
							Enfin vous devez accéder à votre projet non plus par localhost mais par www.mysampleproject.com 
						</p>
						<h1>4. Première connexion</h1>
						<p>A la première connexion il n'y a pas encore d'utilisateur enregistré en base de données.<br />
							Il faut donc spécifier un (ou plusieurs) compte administrateur dans le fichier de configuration.
							<pre>
vsbo.admin=sylvain.gourio@gmail.com
%prod.vsbo.admin=sylvain.gourio@gmail.com
							</pre>
						</p>
					</div>
				</div>
			</div>
			#{/if}
        </div>
    </body>
</html>



